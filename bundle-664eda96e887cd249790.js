(()=>{var e={758:e=>{e.exports={backgroundImages:["bg0.webp","bg1.webp","bg2.webp","bg3.webp","bg4.webp","bg5.webp","bg6.webp","bg7.webp","bg8.webp","bg9.webp","bg10.webp","bg11.webp"]}},586:e=>{"use strict";e.exports=JSON.parse('{"kiara calli":{"lastName":"takamori","firstName":"killiope"}}')},371:(e,t,n)=>{const o=n(586),r=n(523),a="lastName",i="firstName";function s(e){return e[0].toUpperCase()+e.slice(1)}function c(e,t){return function(e,t){return e.slice(-1).toLowerCase()===t[0].toLowerCase()}(e,t)?e.slice(0,-1)+t:e+t}function l(e){return e||"undefined"}function f(e,t){const n=function(e,t){return r.getTalentId(e)+" "+r.getTalentId(t)}(e,t);if(n in o)return o[n]}function u(e,t,n){return function(e,t,n,o){const r=c(e,t);return r===n||r===o?c(e,o):r}(e[n+"Before"],t[n+"After"],e[n],t[n])}function d(e,t,n){return e[n]&&t[n]?u(e,t,n):e[n]||t[n]}function h(e,t){if(e===t)return function(e){return{lastName:s(e.lastName),firstName:s(e.firstName)}}(e);const n=f(e,t);return n||{lastName:d(e,t,a),firstName:d(e,t,i)}}function g(e){const t=[];for(const n of["lastName","firstName"])e[n]&&t.push(s(e[n]));return t.join(" ")}function m(e){return s(l(e.lastName))+" "+s(l(e.firstName))}function y(e,t){return[{talent1:e,talent2:t,fusion:h(e,t)},{talent1:t,talent2:e,fusion:h(t,e)}]}function w(e,t,n){const o=m(e),r=m(t),a=m(n);console.log(o+" + "+r+" = "+a)}e.exports={getFullNameStringById:function(e){return g(r.getTalentById(e))},getFusionStringByIds:function(e,t){return g(function(e,t){return h(r.getTalentById(e),r.getTalentById(t))}(e,t))},printAllNameVariations:function(){const e=function(){const e=[],t=r.getTalentIdsAll();for(let n=0;n<t.length;n++)for(let o=n+1;o<t.length;o++){const a=r.getTalentById(t[n]),i=r.getTalentById(t[o]);e.push(...y(a,i))}return e}();for(const t of e)w(t.talent1,t.talent2,t.fusion)},printAllNameVariationsForTalent:function(e){const t=function(e){const t=[],n=r.getTalentIdsAll();for(const o of n){if(e===o)continue;const n=r.getTalentById(e),a=r.getTalentById(o);t.push(...y(n,a))}return t}(e);for(const e of t)w(e.talent1,e.talent2,e.fusion)}}},523:(e,t,n)=>{const o=n(954),r=n(891);function a(){return r.getObjectLength(o)}function i(){return Object.entries(o).filter((e=>e[1].enabled)).map((e=>e[0]))}function s(){return i().length}e.exports={calculateTalentVariationsAll:function(){return r.calculateVariations(a())},calculateTalentVariationsEnabled:function(){return r.calculateVariations(s())},getTalentById:function(e){const t=o[e];if(!t)throw new Error("talent not found");return t},getTalentCountAll:a,getTalentCountEnabled:s,getTalentId:function(e){for(const t of Object.entries(o))if(e===t[1])return t[0]},getTalentIdsAll:function(){return Object.keys(o)},getTalentIdsEnabled:i}},954:e=>{"use strict";e.exports=JSON.parse('{"pekora":{"enabled":true,"lastName":"usada","firstName":"pekora","lastNameBefore":"usa","lastNameAfter":"sada","firstNameBefore":"peko","firstNameAfter":"kora","drawFirst":{"hair":{"colors":["#acc0f2","#ffffff","#5f6aaf","#bdbdd7"]},"body":{"colors":["#ffffff","#4375f5","#a0cdfb","#dce5f1"]},"etc":{"colors":["#ff8437","#4375f5","#a0cdfb"]},"mouth":{"x":0.509090909090909,"y":0.32,"width":0.7,"hasCutout":true,"hasBlend":true},"nose":{"x":0.5,"y":0.6867469879518072},"eyes":{"areDifferent":false,"left":0.16,"right":0.89,"y":0.49044585987261147}},"drawSecond":{"hair":{"count":2},"body":{"count":3},"mouth":{"y":0.522,"width":0.045},"nose":{"y":0.48433333333333334},"eyes":{"sides":"both","faceCenterXToEyeDistance":0.033,"width":0.055,"y":0.44666666666666666},"faceCenterX":0.5}},"anya":{"enabled":true,"lastName":"melfissa","firstName":"anya","lastNameBefore":"melfi","lastNameAfter":"fissa","firstNameBefore":"an","firstNameAfter":"nya","drawFirst":{"hair":{"colors":["#99797e","#f8d176","#bf977a","#f6b575"]},"body":{"colors":["#61637c","#f8d176","#9a7e90"]},"etc":{"colors":["#f8d176","#61637c","#9a7e90","#cec8bc"]},"mouth":{"x":0.5328947368421053,"y":0.85,"width":0.868421052631579,"hasBlend":true},"nose":{"x":0.5,"y":0.375},"eyes":{"areDifferent":false,"left":0.11,"right":0.92,"y":0.32}},"drawSecond":{"hair":{"count":2},"body":{"count":2},"mouth":{"y":0.5525378450578807,"width":0.0675},"nose":{"y":0.4866429207479964},"eyes":{"sides":"both","faceCenterXToEyeDistance":0.055,"width":0.109,"y":0.43766696349065004},"faceCenterX":0.5031166518254675}},"calli":{"enabled":true,"lastName":"mori","firstName":"calliope","lastNameBefore":"mori","lastNameAfter":"mori","firstNameBefore":"calli","firstNameAfter":"lliope","drawFirst":{"hair":{"colors":["#f8ccde","#e48096"]},"body":{"colors":["#302c2c","#9b7f6c"]},"etc":{"colors":["#ca1748","#f68d9f"]},"mouth":{"x":0.47668393782383417,"y":0.2871287128712871,"width":0.8497409326424871,"hasBlend":true},"nose":{"x":0.4827586206896552,"y":0.5397727272727273},"eyes":{"areDifferent":false,"left":0.15,"right":0.91,"y":0.5638297872340425}},"drawSecond":{"hair":{"count":1},"body":{"count":2},"etc":{"count":1},"mouth":{"y":0.5416991426344505,"width":0.0646921278254092},"nose":{"y":0.49727201870615745},"eyes":{"sides":"both","faceCenterXToEyeDistance":0.0535,"width":0.0925,"y":0.4247856586126267},"faceCenterX":0.49571317225253314}},"kiara":{"enabled":true,"lastName":"takanashi","firstName":"kiara","lastNameBefore":"taka","lastNameAfter":"nashi","firstNameBefore":"kia","firstNameAfter":"ara","drawFirst":{"hair":{"colors":["#ff8161","#bdead7","#63b8d6"]},"body":{"colors":["#fd622a","#393e78","#ffffff","#f2270a"]},"etc":{"colors":["#69ebc9","#febc6e","#e0f962"]},"mouth":{"x":0.49382716049382713,"y":0.6590909090909091,"width":0.9135802469135802,"hasBlend":true},"nose":{"x":0.4,"y":0.6530612244897959},"eyes":{"areDifferent":false,"left":0.14583333333333334,"right":0.95,"y":0.5103448275862069}},"drawSecond":{"hair":{"count":3},"body":{"count":3},"etc":{"count":3},"mouth":{"y":0.5395014786649768,"width":0.06252640473172792},"nose":{"y":0.4816223067173637},"eyes":{"sides":"both","faceCenterXToEyeDistance":0.051964512040557666,"width":0.084,"y":0.4224757076468103},"faceCenterX":0.5006337135614702}},"ina":{"enabled":true,"lastName":"ninomae","firstName":"ina\'nis","lastNameBefore":"nino","lastNameAfter":"mae","firstNameBefore":"ina","firstNameAfter":"\'nis","drawFirst":{"hair":{"colors":["#695982","#f3a35f","#50445e","#ffba76"]},"body":{"colors":["#554d5f","#876b9c","#e8e4ed"]},"etc":{"colors":["#a94665","#ad6ca2","#e8e4ed"]},"mouth":{"x":0.46153846153846156,"y":0.36,"width":1.2,"hasBlend":true},"nose":{"x":0.48717948717948717,"y":0.7246376811594203},"eyes":{"areDifferent":false,"left":0.16037735849056603,"right":0.9716981132075472,"y":0.5}},"drawSecond":{"hair":{"count":3},"body":{"count":3},"etc":{"count":1},"mouth":{"y":0.5663538873994638,"width":0.04},"nose":{"y":0.524798927613941},"eyes":{"sides":"both","faceCenterXToEyeDistance":0.036193029490616625,"width":0.062,"y":0.48525469168900803},"faceCenterX":0.5013404825737265}},"gura":{"enabled":true,"lastName":"gawr","firstName":"gura","lastNameBefore":"gawr","lastNameAfter":"gawr","firstNameBefore":"gu","firstNameAfter":"ra","drawFirst":{"hair":{"colors":["#f3f3f3","#5e9ad2","#e2e3e5","#afebe3"]},"body":{"colors":["#33739d","#b3b3b3","#ffffff"]},"etc":{"colors":["#b3b3b3","#ffffff"]},"mouth":{"x":0.4895833333333333,"y":0.9090909090909091,"width":1,"hasBlend":true},"nose":{"x":0.47619047619047616,"y":0.6166666666666667},"eyes":{"areDifferent":false,"left":0.052434456928838954,"right":0.9737827715355806,"y":0.5}},"drawSecond":{"hair":{"count":2},"body":{"count":2},"mouth":{"y":0.5696252465483235,"width":0.0757396449704142},"nose":{"y":0.5088757396449705},"eyes":{"sides":"both","faceCenterXToEyeDistance":0.05798816568047337,"width":0.09861932938856016,"y":0.44260355029585796},"faceCenterX":0.49940828402366866}}}')},891:e=>{function t(e){return Math.floor(e*Math.random())}e.exports={calculateVariations:function(e){return e*e-e},getObjectLength:function(e){return Object.keys(e).length},getRandomInt:t,getRandomIntUnique:function(e,n){"number"==typeof n&&(n=[n]);let o=n[0];for(;n.includes(o);)o=t(e);return o},mod:function(e,t){return(e%t+t)%t}}}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var a=t[o]={exports:{}};return e[o](a,a.exports,n),a.exports}(()=>{"use strict";var e=n(758),t=n(891),o=n(371),r=n(523);const a="images/talents/",i=".webp",s=["hair","body","etc"];function c(e){const t=new Image;return t.src=e,t}function l(e){return new Promise((t=>{e.onload=()=>t(e)}))}function f(e,t){t.push(l(e))}function u(e){if(e.length<=1)return;const{width:t,height:n}=e[0];for(const o of e)if(o.width!==t||o.height!==n)throw new Error("images are of different sizes")}function d(e,t){return e/t}function h(e,t,n){return{width:e,height:n*(e/t)}}function g(e,t,n){return{width:t*(e/n),height:e}}function m(e,t,n,o){return d(e,t)>d(n,o)}function y(e,t,n){return function(e,t,n){return e*(1-n)+t*n}(0,e-t,n)}function w(e){const t=document.createElement("canvas");return t.width=e.width,t.height=e.height,t}async function b(e,t){const n=document.createElement("canvas");if(e===t)return async function(e,t){const n=c(a+t+"-original"+i);return await l(n),e.width=n.width,e.height=n.height,e.getContext("2d").drawImage(n,0,0),e}(n,e);const o=n.getContext("2d"),d=await async function(e,t){const n=(0,r.getTalentById)(e).drawFirst,o=(0,r.getTalentById)(t).drawSecond,l={},u=[],d=c(a+t+"-base"+i);if(l.baseImage=d,f(d,u),n.mouth&&o.mouth){if(l.mouth={},n.mouth.hasBlend){const t=c(a+e+"-mouth-blend"+i);l.mouth.blend=t,f(t,u)}if(n.mouth.hasCutout){const t=c(a+e+"-mouth-cutout"+i);l.mouth.cutout=t,f(t,u)}}if(n.nose&&o.nose){const t=c(a+e+"-nose"+i);l.nose=t,f(t,u)}if(n.eyes&&o.eyes){const t=o.eyes.sides;if(l.eyes={},!n.eyes.areDifferent||"right"!==t){const t=c(a+e+"-eye-left"+i);l.eyes.left=t,f(t,u)}if(n.eyes.areDifferent&&("both"===t||"right"===t)){const t=c(a+e+"-eye-right"+i);l.eyes.right=t,f(t,u)}}for(const e of s)if(n[e]&&o[e]){l[e]=[];for(let n=0;n<o[e].count;n++){const o=c(a+t+"-"+e+"-"+n+i);l[e].push(o),f(o,u)}}return await Promise.all(u),l}(e,t),g=(0,r.getTalentById)(e).drawFirst,m=(0,r.getTalentById)(t).drawSecond,y=d.baseImage,b=[];for(const e of s)if(d[e])for(const t of d[e])b.push(t);u(b.concat([y])),n.width=y.width,n.height=y.height;const p=w(n),I=p.getContext("2d");I.drawImage(y,0,0),I.globalCompositeOperation="saturation",I.fillStyle="black",I.fillRect(0,0,p.width,p.height);const N=w(n),k=N.getContext("2d");for(const e of b)k.drawImage(e,0,0);I.globalCompositeOperation="destination-in",I.drawImage(N,0,0),o.drawImage(y,0,0),o.drawImage(p,0,0);const S=y.width*m.faceCenterX;if(d.mouth){u(Object.values(d.mouth));const e=d.mouth.blend||d.mouth.cutout,t=e.width*g.mouth.width,n=y.width*m.mouth.width,r=y.height*m.mouth.y,a=n/t,i=h(a*e.width,e.width,e.height),s=S-i.width*g.mouth.x,c=r-i.height*g.mouth.y;if(d.mouth.blend&&(o.save(),o.globalCompositeOperation="difference",o.drawImage(d.mouth.blend,s,c,i.width,i.height),o.restore()),d.mouth.cutout&&o.drawImage(d.mouth.cutout,s,c,i.width,i.height),d.nose){const e=d.nose,t=y.height*m.nose.y,n=h(a*e.width,e.width,e.height),r=S-n.width*g.nose.x,i=t-n.height*g.nose.y;o.save(),o.globalCompositeOperation="difference",o.drawImage(e,r,i,n.width,n.height),o.restore()}}if(d.eyes){u(Object.values(d.eyes));const e=d.eyes.left||d.eyes.right,t=e.width*(g.eyes.right-g.eyes.left),n=y.width*m.eyes.width/t,r=y.width*m.eyes.faceCenterXToEyeDistance,a=h(n*e.width,e.width,e.height),i=y.height*m.eyes.y-a.height*g.eyes.y,s=m.eyes.sides;if("both"===s||"left"===s){const t=S-r-a.width*g.eyes.right;o.drawImage(e,t,i,a.width,a.height)}if("both"===s||"right"===s){const e=d.eyes.right||d.eyes.left,t=y.width-S-r-a.width*g.eyes.right;o.save(),o.translate(y.width,0),o.scale(-1,1),o.drawImage(e,t,i,a.width,a.height),o.restore()}}for(const e of s)if(d[e])for(const[t,r]of d[e].entries()){o.save();const a=g[e].colors[t%g[e].colors.length],i=w(n),s=i.getContext("2d");s.drawImage(r,0,0),s.fillStyle=a,s.globalCompositeOperation="overlay",s.fillRect(0,0,i.width,i.height),s.globalCompositeOperation="destination-in",s.drawImage(r,0,0),o.drawImage(i,0,0),o.restore()}return n}let p=0;async function I(e,t,n){const o=++p,r=e.getContext("2d");!function(e){e.clearRect(0,0,e.canvas.width,e.canvas.height)}(r);const a=await b(t,n);if(p!==o)return;!function(e){e.save(),e.fillStyle="white",e.fillRect(0,0,e.canvas.width,e.canvas.height),e.restore()}(r);const{width:i,height:s}=(c=e.width,l=e.height,f=a.width,u=a.height,m(f,u,c,l)?h(c,f,u):g(l,f,u));var c,l,f,u;r.drawImage(a,y(e.width,i,.5),y(e.height,s,1),i,s)}const N=document.querySelector.bind(document),k=[".talent-dropdown",".talent-select-button-imgs",".talent-select-name",".talent-select-image"],S=(0,r.getTalentIdsEnabled)(),T=[];let x;function v(e){return(0,t.mod)(e,S.length)}function B(e){return e.content.cloneNode(!0)}function C(e){return parseInt(e.dataset.talentIndex)}function q(e,t){e.dataset.talentIndex=t}function E(){return[S[C(T[0])],S[C(T[1])]]}function L(e){return e.closest(".talent-select-container")}function A(e){q(e,v(C(e)-1)),M()}function _(e){q(e,v(C(e)+1)),M()}function D(e){A(L(e.target))}function O(e){_(L(e.target))}function F(e){if(S.length<=1)return;const n=C(e);let o;if(2===S.length)o=v(n+1);else{const r=C(function(e){return e===T[0]?T[1]:T[0]}(e));o=(0,t.getRandomIntUnique)(S.length,[n,r])}q(e,o),M()}function X(e){F(L(e.target))}function R(){if(S.length<=1)return;const e=C(T[0]),n=(0,t.getRandomIntUnique)(S.length,e),o=C(T[1]);let r=o;r=2===S.length?v(n+1):(0,t.getRandomIntUnique)(S.length,[o,n]),q(T[0],n),q(T[1],r),M()}function j(){const e=C(T[0]),t=C(T[1]);q(T[0],t),q(T[1],e),M()}function H(){!function(){const e=N(".template-talent-select");for(let t=1;t<=2;t++){const n=B(e);n.querySelector(".talent-select-container").classList.add(`talent-select-container-${t}`),n.querySelector(".talent-select-box").classList.add(`talent-select-box-${t}`),n.querySelector(".talent-dropdown").classList.add(`talent-dropdown-${t}`),N(".main").appendChild(n)}}(),function(){const e=(0,t.getRandomInt)(S.length);for(let t=0;t<2;t++){const n=N(`.talent-select-container-${t+1}`);q(n,e),n.querySelector(".talent-select-image").onclick=Q,n.querySelector(".talent-select-name__name").onclick=Q,n.querySelector(".button-img-up").onclick=D,n.querySelector(".button-img-down").onclick=O,n.querySelector(".button-img-random").onclick=X,T[t]=n}}(),function(){for(const e of T){const t=e.querySelector(".talent-dropdown");Y(t),document.addEventListener("click",(e=>{Z(e,t)})),document.addEventListener("keydown",(e=>{ee(e,t)}))}}()}function V(e){!function(e){const t=S[C(e)];e.querySelector(".talent-select-image").style.setProperty("--image-url",`url(images/talents/${t}-medium.webp)`)}(e),function(e){e.querySelector(".talent-select-name__name").innerHTML=(0,o.getFullNameStringById)(S[C(e)])}(e),function(e){!function(e){for(const t of e.querySelectorAll(".talent-dropdown-entries__entry"))t.classList.remove("talent-dropdown-entries__entry--highlighted")}(e.querySelector(".talent-dropdown"));const t=U(e);n=t,n.classList.add("talent-dropdown-entries__entry--highlighted"),P(t);var n}(e)}function $(){!function(){const[e,t]=E();N(".result-name").innerHTML=(0,o.getFusionStringByIds)(e,t)}(),function(){const e=N(".result-canvas");var t;(t=e).style.animation="none",t.offsetHeight,t.style.animation=null,I(e,...E())}()}function M(){!function(){for(const e of T)V(e)}(),$()}function P(e){const t=e.closest(".talent-dropdown-entries"),n=e.offsetTop-t.offsetHeight/2+e.offsetHeight/2;t.scrollTop=n}function U(e){return function(e,t){return e.querySelector(`[data-talent-index="${t}"]`)}(e,C(L(e)))}function J(e){!function(e){for(const t of k)e.querySelector(t).classList.add("dropdown-visible")}(e),P(U(e.querySelector(".talent-dropdown")))}function z(e){!function(e){for(const t of k)e.querySelector(t).classList.remove("dropdown-visible")}(e)}function G(e){const t=e.currentTarget,n=L(t);q(n,t.dataset.talentIndex),z(n),M()}function K(e){return e.querySelector(".talent-dropdown").classList.contains("dropdown-visible")}function Q(e){const t=L(e.target);K(t)||(J(t),e.ifDropdownElementJustShown=t.querySelector(".talent-dropdown"))}function W(e,t,n){const r=B(N(".template-talent-dropdown-entry"));r.querySelector(".talent-dropdown-entries__entry__image").style.setProperty("--image-url",`url(images/talents/${n}-small.webp)`);const a=(0,o.getFullNameStringById)(n);r.querySelector(".talent-dropdown-entries__entry__name").innerHTML=a,e.querySelector(".talent-dropdown-entries").appendChild(r);const i=e.querySelector(".talent-dropdown-entries").lastElementChild;i.dataset.talentIndex=t,i.onclick=G,i.onmouseup=G}function Y(e){for(let t=0;t<S.length;t++)W(e,t,S[t])}function Z(e,t){e.ifDropdownElementJustShown!==t&&z(L(t))}function ee(e,t){const n=L(t);if(!K(n))return;const o={ArrowUp:()=>{A(n)},ArrowDown:()=>{_(n)},Enter:()=>{z(n)}};o[e.key]&&(o[e.key](),e.preventDefault())}function te(){localStorage.removeItem("backgroundIndex")}function ne(t){x=t,N(".background").style.setProperty("--image-url",`url(images/backgrounds/${e.backgroundImages[t]})`)}function oe(){localStorage.setItem("backgroundIndex",x)}function re(n){return(0,t.mod)(n,e.backgroundImages.length)}function ae(){const n=function(){const e=localStorage.getItem("backgroundIndex");if("string"==typeof e&&e.match(/^\d+/))return parseInt(e)}();var o;"number"!=typeof(o=n)||o<0||o>=e.backgroundImages.length?(ne((0,t.getRandomInt)(e.backgroundImages.length)),te()):ne(n)}function ie(){N(".info").classList.remove("info--in"),N(".info").classList.add("info--out")}function se(){const n=N(".info").classList;N(".info-button").onclick=e=>{n.contains("info--in")||(N(".info").classList.remove("info--out"),N(".info").classList.add("info--in"),e.stopPropagation())},window.onkeydown=e=>{n.contains("info--in")&&"Escape"===e.key&&ie()},window.onclick=()=>{n.contains("info--in")&&ie()},N(".info__close").onclick=()=>{ie()},N(".info").onclick=e=>{e.stopPropagation()},N(".background-forwards").onclick=()=>(x=re(++x),ne(x),void oe()),N(".background-backwards").onclick=()=>(x=re(--x),ne(x),void oe()),N(".background-random").onclick=()=>(ne((0,t.getRandomIntUnique)(e.backgroundImages.length,x)),void te()),N(".current-progress").innerHTML=(0,r.getTalentCountEnabled)(),N(".possible-variations").innerHTML=(0,r.calculateTalentVariationsEnabled)()}H(),function(){const e=N(".result-box");e.querySelector(".button-img-random").onclick=R,e.querySelector(".button-img-swap").onclick=j}(),M(),ae(),se()})()})();